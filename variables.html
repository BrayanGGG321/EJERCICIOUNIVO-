<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootcamp IO: Formulaci贸n de Problemas | UNIVO</title>
    <style>
        /* --- CORE THEME: UNIVO 2026 --- */
        :root {
            --u-yellow: #F9B410;
            --u-dark: #05080D;
            --u-gray: #E7E7E7;
            --u-white: #FFFFFF;
            --u-blue-accent: #004d99;
            --u-success: #28a745;
            --u-error: #dc3545;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--u-gray);
            color: var(--u-dark);
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 280px;
            background-color: var(--u-dark);
            color: var(--u-white);
            display: flex;
            flex-direction: column;
            border-right: 5px solid var(--u-yellow);
        }

        .logo-area {
            padding: 20px;
            text-align: center;
            background-color: #000;
        }

        .logo-area h2 { margin: 0; color: var(--u-yellow); letter-spacing: 1px; }
        .logo-area p { margin: 5px 0 0; font-size: 0.8em; color: #aaa; }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .nav-btn {
            width: 100%;
            padding: 15px 20px;
            background: none;
            border: none;
            color: #ccc;
            text-align: left;
            font-size: 1em;
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s;
        }

        .nav-btn:hover { background-color: rgba(255,255,255,0.05); color: white; }
        
        .nav-btn.active {
            background-color: rgba(249, 180, 16, 0.1);
            color: var(--u-yellow);
            border-left-color: var(--u-yellow);
            font-weight: bold;
        }

        .progress-widget {
            padding: 20px;
            background-color: #111;
            border-top: 1px solid #333;
        }

        /* --- MAIN CONTENT --- */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            background-color: #f4f6f8;
        }

        .container { max-width: 900px; margin: 0 auto; }

        .card {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-top: 4px solid transparent;
        }
        .card.theory { border-top-color: var(--u-blue-accent); }
        .card.practice { border-top-color: var(--u-yellow); }

        h1, h2, h3 { color: var(--u-dark); }
        .highlight { background-color: rgba(249, 180, 16, 0.3); padding: 0 5px; border-radius: 3px; }

        .question-row {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .question-row:last-child { border-bottom: none; }
        
        select, input[type="text"], textarea {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.95em;
            width: 100%;
        }
        select { width: auto; }
        textarea { height: 80px; margin-top: 10px; }

        .btn-action {
            background-color: var(--u-yellow);
            color: var(--u-dark);
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .btn-action:hover { background-color: #e0a20e; }
        .btn-disabled { background-color: #ccc; cursor: default; transform: none; box-shadow: none; }

        .feedback-box {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9em;
            display: none;
        }
        .fb-correct { background-color: #d4edda; color: #155724; }
        .fb-error { background-color: #f8d7da; color: #721c24; }

        .progress-track { width: 100%; height: 10px; background: #333; border-radius: 5px; margin-top: 10px; }
        .progress-fill { height: 100%; background: var(--u-yellow); width: 0%; border-radius: 5px; transition: width 0.5s; }

        .hidden { display: none; }
        .badge {
            display: inline-block; padding: 3px 8px; font-size: 0.75em; 
            border-radius: 10px; background: #eee; margin-left: 10px;
        }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo-area">
        <h2>UNIVO | IO</h2>
        <p>Investigaci贸n de Operaciones</p>
    </div>
    <div class="nav-menu">
        <button class="nav-btn active" onclick="showSection('intro')">1. Introducci贸n y Teor铆a</button>
        <button class="nav-btn" onclick="showSection('level1')">2. Drill: Clasificaci贸n <span id="badge1" class="badge">0/20</span></button>
        <button class="nav-btn" onclick="showSection('level2')">3. Lab: Depuraci贸n <span id="badge2" class="badge">0/5</span></button>
        <button class="nav-btn" onclick="showSection('level3')">4. Casos de Negocios <span id="badge3" class="badge">0/5</span></button>
        <button class="nav-btn" onclick="showSection('final')">5. Certificaci贸n Final</button>
        <button class="nav-btn" onclick="resetProgress()" style="color: #dc3545; margin-top: 20px;">锔 Reiniciar Todo</button>
    </div>
    <div class="progress-widget">
        <small style="color: #aaa;">Progreso General</small>
        <div class="progress-track"><div class="progress-fill" id="globalProgress"></div></div>
        <div style="text-align: right; color: var(--u-yellow); font-weight: bold; margin-top: 5px;" id="percentText">0%</div>
    </div>
</div>

<div class="main-content">
    
    <div id="intro" class="container section">
        <div class="card theory">
            <h1>M贸dulo Intensivo: El Arte de Plantear Problemas</h1>
            <p>Bienvenido al Bootcamp de Formulaci贸n de Investigaci贸n de Operaciones. Duraci贸n estimada: <strong>1 hora</strong>.</p>
            <p><strong>Nota:</strong> Tu progreso se guarda autom谩ticamente.</p>
        </div>
        
        <div class="card theory">
            <h3> Lectura: La Anatom铆a de una Variable</h3>
            <p>En IO aplicada a negocios, una variable (X) es una <strong>decisi贸n cuantificable</strong>:</p>
            <ol>
                <li><strong>驴Qu茅 es?</strong> (Cantidad, Porcentaje, Decisi贸n).</li>
                <li><strong>驴De qu茅?</strong> (Sillas Modelo A, Inversi贸n).</li>
                <li><strong>驴Unidad?</strong> (Por semana, Por d铆a).</li>
            </ol>
            <hr>
            <h4>Tipos de Variables:</h4>
            <ul>
                <li><strong>Continuas (L):</strong> Dinero, L铆quidos, Tiempo. (Admiten decimales).</li>
                <li><strong>Enteras (I):</strong> Personas, Veh铆culos, Proyectos. (No admiten decimales).</li>
                <li><strong>Binarias (B):</strong> Decisiones "S铆/No". (1 o 0).</li>
            </ul>
        </div>
        <button class="btn-action" onclick="showSection('level1')">Comenzar Entrenamiento</button>
    </div>

    <div id="level1" class="container section hidden">
        <div class="card practice">
            <h2>Nivel 1: Clasificaci贸n R谩pida (The Drill)</h2>
            <p>Clasifica las 20 variables. (C = Continua, E = Entera, B = Binaria)</p>
            <div id="drill-container"></div>
            <button class="btn-action" onclick="checkLevel1()">Verificar Nivel 1</button>
        </div>
    </div>

    <div id="level2" class="container section hidden">
        <div class="card practice">
            <h2>Nivel 2: Laboratorio de Depuraci贸n</h2>
            <p>Indica cu谩l es el error en los planteamientos del analista junior.</p>
            <div id="debug-container"></div>
            <button class="btn-action" onclick="checkLevel2()">Verificar Correcciones</button>
        </div>
    </div>

    <div id="level3" class="container section hidden">
        <div class="card practice">
            <h2>Nivel 3: Casos de Negocio (Business Cases)</h2>
            <p>Redacta las variables de decisi贸n para los siguientes escenarios.</p>
            <div id="cases-container"></div>
        </div>
    </div>

    <div id="final" class="container section hidden">
        <div class="card theory" style="text-align: center;">
            <h1>Certificaci贸n de Competencias</h1>
            <p>Has completado el recorrido de entrenamiento.</p>
            <div style="font-size: 3em; margin: 20px;"></div>
            <p>Puntaje Final Acumulado: <strong id="finalScoreDisplay">0</strong>%</p>
            <button class="btn-action" onclick="window.print()">Imprimir Evidencia PDF</button>
        </div>
    </div>

</div>

<script>
    // --- DATOS ---
    const drillQuestions = [
        { q: "N煤mero de camiones a asignar a la Ruta 1.", type: "E" },
        { q: "Litros de leche utilizados para queso fresco.", type: "C" },
        { q: "Decisi贸n de abrir o no una sucursal en San Miguel.", type: "B" },
        { q: "Porcentaje del presupuesto invertido en Bitcoin.", type: "C" },
        { q: "Cantidad de enfermeras en turno nocturno.", type: "E" },
        { q: "Tiempo exacto de procesamiento en m谩quina A.", type: "C" },
        { q: "N煤mero de bonos del tesoro a comprar.", type: "E" },
        { q: "Asignaci贸n de un proyecto al equipo A (S铆/No).", type: "B" },
        { q: "Kilogramos de harina en inventario.", type: "C" },
        { q: "Cantidad de escritorios a fabricar.", type: "E" },
        { q: "Dinero ($) gastado en publicidad.", type: "C" },
        { q: "N煤mero de vuelos comerciales diarios.", type: "E" },
        { q: "Decisi贸n de renovar contrato a proveedor X.", type: "B" },
        { q: "Metros de tela cortados.", type: "C" },
        { q: "Cantidad de pasajeros en un bus.", type: "E" },
        { q: "Temperatura del horno industrial.", type: "C" },
        { q: "N煤mero de acciones a vender.", type: "E" },
        { q: "Selecci贸n de la ruta m谩s corta (Binaria).", type: "B" },
        { q: "Horas hombre requeridas.", type: "C" },
        { q: "Cantidad de contenedores embarcados.", type: "E" }
    ];

    const debugQuestions = [
        { 
            context: "F谩brica de Zapatos", bad: "x = zapatos", 
            options: ["Es correcta", "Falta definir cantidad y tiempo", "Deber铆a ser Binaria"],
            ans: "Falta definir cantidad y tiempo"
        },
        { 
            context: "Inversi贸n", bad: "x = Ganancia", 
            options: ["x es una variable de salida, no de entrada", "x deber铆a ser costos", "Est谩 bien"],
            ans: "x es una variable de salida, no de entrada"
        },
        { 
            context: "Transporte", bad: "x = Cami贸n de placa AB-123", 
            options: ["Es muy espec铆fico", "Est谩 perfecto", "Falta el color del cami贸n"],
            ans: "Es muy espec铆fico"
        },
        { 
            context: "Selecci贸n de Personal", bad: "x = N煤mero de gerentes (donde x = 2.5)", 
            options: ["Debe ser Entera", "Debe ser Continua", "Debe ser Binaria"],
            ans: "Debe ser Entera"
        },
        { 
            context: "Producci贸n", bad: "x = Costo de materia prima", 
            options: ["Es un Par谩metro, no Variable", "Es Binaria", "Es una Restricci贸n"],
            ans: "Es un Par谩metro, no Variable"
        }
    ];

    const businessCases = [
        {
            title: "Caso 1: Mix de Medios (Marketing)",
            desc: "Decidir cu谩ntos anuncios poner en TV, Radio y cu谩nto invertir en Redes Sociales.",
            solution: "x1: Cantidad de spots en TV (Entera)\nx2: Cantidad de spots en Radio (Entera)\nx3: D贸lares a invertir en Redes Sociales (Continua)"
        },
        {
            title: "Caso 2: Problema de la Mochila (Log铆stica)",
            desc: "Decidir cu谩ntas cajas de 5 tipos diferentes llevar en un cami贸n para maximizar valor.",
            solution: "xi: Cantidad de cajas del tipo 'i' a cargar.\nTipo: Enteras Positivas."
        },
        {
            title: "Caso 3: Localizaci贸n (Estrat茅gico)",
            desc: "Elegir 2 ubicaciones de 4 posibles (San Miguel, Usulut谩n, La Uni贸n, Moraz谩n).",
            solution: "yj: Variable Binaria (1 si se abre en la ubicaci贸n j, 0 si no).\nRestricci贸n: Suma de yj = 2"
        },
        {
            title: "Caso 4: Dieta (Nutrici贸n/Costos)",
            desc: "Mezclar Pollo, Arroz y Verduras para cumplir vitaminas minimizando costo.",
            solution: "xi: Gramos del ingrediente 'i' en la mezcla.\nTipo: Continua."
        },
        {
            title: "Caso 5: Asignaci贸n (RRHH)",
            desc: "3 empleados, 3 tareas. Cada uno hace una.",
            solution: "xij: Variable Binaria. 1 si el empleado 'i' hace la tarea 'j'."
        }
    ];

    // --- ESTADO (State) ---
    let state = {
        l1_answers: {},
        l2_answers: {},
        l3_completed: [], // Guarda los 铆ndices completados
        l3_text: {} // NUEVO: Guarda el texto escrito por el alumno
    };

    // --- INICIALIZACIN ---
    window.onload = function() {
        // 1. PRIMERO dibujamos la interfaz (Importante para que existan los elementos)
        renderLevel1();
        renderLevel2();
        renderLevel3();
        
        // 2. LUEGO cargamos los datos guardados
        loadProgress();
        updateUI();
    };

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        // Marcar activo en sidebar (simple)
        const buttons = document.querySelectorAll('.nav-btn');
        if(id === 'intro') buttons[0].classList.add('active');
        if(id === 'level1') buttons[1].classList.add('active');
        if(id === 'level2') buttons[2].classList.add('active');
        if(id === 'level3') buttons[3].classList.add('active');
        if(id === 'final') buttons[4].classList.add('active');
        window.scrollTo(0,0);
    }

    // --- RENDERING ---
    function renderLevel1() {
        const container = document.getElementById('drill-container');
        drillQuestions.forEach((item, index) => {
            container.innerHTML += `
                <div class="question-row">
                    <span style="flex:1">${index + 1}. ${item.q}</span>
                    <select id="l1_q${index}" onchange="saveL1(${index}, this.value)" style="flex:0 0 150px">
                        <option value="">Seleccionar...</option>
                        <option value="C">Continua</option>
                        <option value="E">Entera</option>
                        <option value="B">Binaria</option>
                    </select>
                </div>
                <div id="l1_fb${index}" class="feedback-box"></div>
            `;
        });
    }

    function renderLevel2() {
        const container = document.getElementById('debug-container');
        debugQuestions.forEach((item, index) => {
            container.innerHTML += `
                <div class="card" style="background:#f9f9f9;">
                    <h4>${index+1}. Contexto: ${item.context}</h4>
                    <p class="highlight" style="display:inline-block;">Definici贸n Mala: "${item.bad}"</p>
                    <select id="l2_q${index}" style="width:100%; margin-top:10px;">
                        <option value="">-- Diagn贸stico --</option>
                        ${item.options.map(o => `<option value="${o}">${o}</option>`).join('')}
                    </select>
                    <div id="l2_fb${index}" class="feedback-box"></div>
                </div>
            `;
        });
    }

    function renderLevel3() {
        const container = document.getElementById('cases-container');
        businessCases.forEach((item, index) => {
            container.innerHTML += `
                <div class="card" style="border-left: 5px solid var(--u-blue-accent);">
                    <h3>${item.title}</h3>
                    <p>${item.desc}</p>
                    <textarea id="case_${index}" placeholder="Define las variables aqu铆..." oninput="saveL3Text(${index})"></textarea>
                    <button id="btn_case_${index}" class="btn-action" style="padding: 8px 20px; font-size: 0.9em;" onclick="revealCase(${index})">Autoevaluar</button>
                    <div id="case_fb_${index}" class="feedback-box" style="background: #e2e6ea; border: 1px solid #cbd5e0;">
                        <strong>Soluci贸n Experta:</strong><br>
                        <pre style="white-space: pre-wrap; font-family:inherit;">${item.solution}</pre>
                    </div>
                </div>
            `;
        });
    }

    // --- LGICA DE VALIDACIN ---

    function checkLevel1() {
        let correctCount = 0;
        drillQuestions.forEach((item, index) => {
            const val = document.getElementById(`l1_q${index}`).value;
            const fb = document.getElementById(`l1_fb${index}`);
            fb.style.display = 'block';
            
            if(val === item.type) {
                correctCount++;
                fb.className = 'feedback-box fb-correct';
                fb.innerText = "隆Correcto!";
            } else {
                fb.className = 'feedback-box fb-error';
                fb.innerText = `Incorrecto. Correcta: ${item.type === 'C' ? 'Continua' : item.type === 'E' ? 'Entera' : 'Binaria'}.`;
            }
        });
        saveProgress();
        updateUI();
    }

    function checkLevel2() {
        let correctCount = 0;
        debugQuestions.forEach((item, index) => {
            const val = document.getElementById(`l2_q${index}`).value;
            const fb = document.getElementById(`l2_fb${index}`);
            fb.style.display = 'block';

            if(val === item.ans) {
                correctCount++;
                fb.className = 'feedback-box fb-correct';
                fb.innerText = "Diagn贸stico Correcto.";
            } else {
                fb.className = 'feedback-box fb-error';
                fb.innerText = `Error. La raz贸n es: ${item.ans}`;
            }
        });
        // Guardamos las respuestas de L2 tambi茅n para que no se pierdan al recargar (aunque no se ped铆a expl铆cito, es mejor)
        debugQuestions.forEach((_, idx) => {
             state.l2_answers[idx] = document.getElementById(`l2_q${idx}`).value;
        });
        saveProgress();
        updateUI();
    }

    function revealCase(index) {
        document.getElementById(`case_fb_${index}`).style.display = 'block';
        
        // Bloquear bot贸n visualmente para indicar completado
        const btn = document.getElementById(`btn_case_${index}`);
        btn.innerText = "Completado";
        btn.classList.add('btn-disabled');

        if(!state.l3_completed.includes(index)){
            state.l3_completed.push(index);
            saveProgress();
            updateUI();
        }
    }

    // --- ALMACENAMIENTO Y CARGA ---

    function saveL1(index, val) {
        state.l1_answers[index] = val;
        saveProgress();
        updateUI();
    }

    function saveL3Text(index) {
        // Guardar lo que escribe el usuario en tiempo real
        const text = document.getElementById(`case_${index}`).value;
        state.l3_text[index] = text;
        saveProgress();
    }

    function saveProgress() {
        localStorage.setItem('univo_io_bootcamp_v2', JSON.stringify(state));
    }

    function loadProgress() {
        const saved = localStorage.getItem('univo_io_bootcamp_v2');
        if(saved) {
            state = JSON.parse(saved);
            
            // Restaurar L1
            for(const [idx, val] of Object.entries(state.l1_answers || {})){
                let el = document.getElementById(`l1_q${idx}`);
                if(el) el.value = val;
            }

            // Restaurar L2 (si se valid贸 antes)
            for(const [idx, val] of Object.entries(state.l2_answers || {})){
                let el = document.getElementById(`l2_q${idx}`);
                if(el) el.value = val;
            }

            // Restaurar Texto L3 (NUEVO)
            if(state.l3_text) {
                for(const [idx, txt] of Object.entries(state.l3_text)){
                    let el = document.getElementById(`case_${idx}`);
                    if(el) el.value = txt;
                }
            }

            // Restaurar L3 (Visuales de completado)
            if(state.l3_completed) {
                state.l3_completed.forEach(idx => {
                    let fb = document.getElementById(`case_fb_${idx}`);
                    let btn = document.getElementById(`btn_case_${idx}`);
                    if(fb) fb.style.display = 'block';
                    if(btn) {
                        btn.innerText = "Completado";
                        btn.classList.add('btn-disabled');
                    }
                });
            }
        }
    }

    function updateUI() {
        // Badges
        const l1_count = Object.keys(state.l1_answers || {}).length;
        const l2_count = Object.keys(state.l2_answers || {}).length; // Aproximado
        const l3_count = (state.l3_completed || []).length;

        document.getElementById('badge1').innerText = l1_count + "/20";
        document.getElementById('badge2').innerText = (l2_count > 0 ? "Hecho" : "0/5"); 
        document.getElementById('badge3').innerText = l3_count + "/5";
        
        // Barra Global
        // Pesos: L1=30%, L2=30%, L3=40%
        let p1 = (l1_count / 20) * 30;
        let p2 = (l2_count >= 5 ? 1 : 0) * 30; // Simplificado: L2 da puntos si se intent贸
        let p3 = (l3_count / 5) * 40;
        
        let totalPct = Math.min(100, Math.floor(p1 + p2 + p3));
        
        document.getElementById('globalProgress').style.width = totalPct + "%";
        document.getElementById('percentText').innerText = totalPct + "%";
        document.getElementById('finalScoreDisplay').innerText = totalPct;
    }

    function resetProgress() {
        if(confirm("驴Borrar todo el progreso y empezar de cero?")) {
            localStorage.removeItem('univo_io_bootcamp_v2');
            location.reload();
        }
    }

</script>

</body>
</html>
